Quick admin note: there are some typos on Example Sheet 1. The expression in problem 1 should read
\begin{equation*}
    \exp \paren{\frac{im(x-x_0)^2}{2(t-t_0)}
    },
\end{equation*}
where the denominator is not squared, and in problem 2,
\begin{equation*}
    \exp\paren{
        \frac{\ldots-2 x x_0}{\ldots}
    }.
\end{equation*}

Today we shall return to the world of $3+1$ dimensions and set path integrals aside for a moment. Our main result today is the \emph{LSZ reduction formula}, named for Lehmann-Symanzik-Zimmermann (cf. Srednicki \textsection 5). This result provides a direct relationship between scattering amplitudes. For example, consider the $2\to 2$ scattering of real scalar particles. For a free scalar, we have the field written in terms of creation and annihlation operators,
\begin{equation}
    \phi(x)=\int \frac{d^3k}{(2\pi)^3 2E}\bkt{
        a(\vec k) e^{-ik\cdot x}+a^\dagger(\vec k)e^{ik\cdot x}
    }
\end{equation}
where $k\cdot x=Et-\vec k \cdot \vec x$, using the mostly minus $(+---)$ signature.

Equivalently we can Fourier transform the field to find expressions for $a,a^\dagger$ in terms of the field $\phi$:
\begin{gather*}
    \int d^3 x \,e^{ik\cdot x} \phi(x)=\frac{1}{2E}a(\vec k)+\frac{1}{2E} e^{2iEt} a^\dagger(-\vec k),\\
    \int d^3x \,e^{ik\cdot x} \p_0 \phi(x) = -\frac{i}{2} a(\vec k) + \frac{i}{2} e^{2i Et} a^\dagger (-\vec k),
\end{gather*}
which tells us that
\begin{gather}
    a(\vec k)=\int d^3 x\, e^{ik\cdot x}(i\p_0 \phi(x)+E \phi(x)),\\
    a^\dagger(\vec k)= \int d^3 x \, e^{-ik\cdot x}(-i\p_0 \phi(x)+E \phi(x)).
\end{gather}

Now for the free theory, a one-particle momentum eigenstate is given by
\begin{equation}
    \ket{k}= a^\dagger(\vec k)\ket{0},
\end{equation}
with $\ket{0}$ the normalized vacuum state such that $\braket{0}{0}=1$ and $a(\vec k)\ket{0}=0 \forall \vec k$. We require that these momentum eigenstates are (relativistically) normalized such that
\begin{equation}
    \braket{k'}{k}=(2\pi)^3(2E)\delta^{(3)}(\vec k - \vec k'),
\end{equation}
with $E=\sqrt{|\vec k|^2 +m^2}$. We can now describe a Gaussian wavepacket in momentum space by defining the operator
\begin{equation}
    a_1^\dagger \equiv \int d^3 k\, f_1(\vec k)a^\dagger (\vec k)
\end{equation}
where
\begin{equation}
    f_1(\vec k)\propto \exp\bkt{
        -\frac{(\vec k -\vec k_1)^2}{4\sigma^2}
    }
\end{equation}
for some $\vec k_1,\sigma$. We can define a second particle with $a_2^\dagger$ for some $f_2,\vec k_2$ such that $\vec k_2 \neq \vec k_1$. That is, $a_1^\dagger\ket{0}$ is a one-particle state with a Gaussian momentum distribution centered around $\vec{k_1}$.

Now if we evolve Gaussian wavepackets from the far distant past (or future), the overlap between the Gaussians in coordinate space should be small (the particles are far apart in the past and future). Thus their interaction is effectively limited in both space and time to some bounded interaction region. 

We shall assume this works even when interactions are present. However, there is a complication-- in principle, $a^\dagger(\vec k)$ becomes time-dependent, e.g. their energies depend on their proximity to other particles, and therefore $a_1^\dagger(t),a_2^\dagger(t)$ are now functions of time. We therefore assume that as $t\to\pm\infty$, the wavepacket operators $a_1^\dagger,a_2^\dagger$ coincide with the free theory expressions.

Our initial and final (in/out) states are therefore
\begin{align}
    \ket{i}&=\lim_{t\to -\infty} a_1^\dagger(t)a_2^\dagger(t)\ket{0}\\
    \ket{f}&=\lim_{t\to +\infty} a_{1'}^\dagger(t)a_{2'}^\dagger(t)\ket{0}
\end{align}
where initial and final states are normalized, $\braket{i}{i}=\braket{f}{f}=1$, and $\vec k_1\neq \vec k_2, \vec k_1' \neq \vec k_2'.$ The scattering amplitude is then the overlap of the initial and final states, $\braket{f}{i}$.

Note that
\begin{align*}
    a_1^\dagger(\infty)-a_1^\dagger(-\infty)
        &=\int_{-\infty}^\infty dt \,\p_0 a_1^\dagger(t)\\
        &= \int d^3k f_1(\vec k)\int d^4x \p_0 \bkt{e^{-ik\cdot x}(-i\p_0 \phi + E \phi)}\\
        &= -i \int d^3 k f_1(\vec k) \int d^4x e^{-ik\cdot x} (\p_0^2 +E^2)\phi\\
        &= -i \int d^3 k f_1(\vec k)\int d^4 k e^{-ik\cdot x}(\p_0^2 + |\vec k|^2 +m^2)\phi.
\end{align*}
In going from the second to third line, we've canceled the cross terms from the $\p_0$ derivative and pulled the overall factor of $-i$ out front. In the fourth line, we just rewrote $E^2$ in terms of $|\vec k|^2$ and $m^2$. 

However, we also recognize that 
\begin{equation}
    |\vec k|^2 e^{-ik \cdot x} \phi(x) = -\nabla^2 (e^{-ik\cdot x}) \phi (x)= -e^{-ik\cdot x}\nabla^2 \phi(x),
\end{equation}
where the second equality follows from integrating by parts twice, and the wavepacket $f_1(\vec{k})$ has saved us from having to include a boundary term. Therefore this last line becomes
\begin{align}
     a_1^\dagger(\infty)-a_1^\dagger(-\infty) &= -i \int d^3k f_1(\vec k) \int d^4 x e^{-ik\cdot x}(\p_0^2 - \nabla^2 +m^2)\phi\\
        &=-i \int d^3k f_1(\vec k) \int d^4 x e^{-ik\cdot x}(\p^2 +m^2)\phi. \label{adaggerfundamentalthm}
\end{align}
Note that in a free theory, the Klein-Gordon equation tells us that $(\p^2+m^2)\phi=0$, so that $a_1^\dagger(\infty)=a_1^\dagger(-\infty).$

Now
\begin{equation}\label{lsz-timeordered}
    \braket{f}{i}=\bra{0}\mathcal{T}a_{1'}(\infty)a_{2'}(\infty) a_1^\dagger(-\infty) a_2^\dagger(-\infty)\ket{0},
\end{equation}
where $\mathcal{T}$ indicates time ordering. Of course, the expression is already time ordered, so we can insert it for free. We can then rewrite the result \ref{adaggerfundamentalthm} as
\begin{equation}
    a_j^\dagger(-\infty)=a_j^\dagger(\infty)+i\int d^3k\, f_j(\vec k)\int d^4 x\, e^{-ik\cdot x}(\p^2+m^2)\phi,
\end{equation}
and we get a similar expression by taking the hermitian conjugate, $a_{j'}(\infty)=a_{j'}(-\infty)+\ldots$.

We can now substitute into our time-ordered equation \ref{lsz-timeordered}. Time ordering then moves $a_j^\dagger(\infty)$ to the left, annihilating $\bra{0}$ and $a_{j'}(-\infty)$ to the right, annihilating $\ket{0}$. What remains is the integral terms, which form the LSZ formula:
\begin{align*}
    \braket{f}{i}={}&(i)^4 \int d^4 x_1 d^4 x_2 d^4x_{1'} d^4x_{2'}\,  e^{-ik_1\cdot x_1} e^{-ik_2 \cdot x_2} e^{ik_{1'}\cdot x_{1'}} e^{ik_{2'} \cdot x_{2'}}\\
        &\times (\p_1^2 +m^2)(\p_{1'}^2+m^2)(\p_2^2+m^2)(\p_{2'}^2 +m^2)
        \bra{0}\mathcal{T} \phi(x_1)\phi(x_2)\phi(x_{1'})\phi(x_{2'})\ket{0},
\end{align*}
having taken the $\sigma\to 0$ limit in all the $f_j(\vec k)$ so to get delta functions $\delta^{(3)}(\vec k -\vec k_j)$. It's this last term, the expectation value of the time-ordered fields, which contains all the physics.

We have the following assumptions in this formula (noting that the interacting $\phi$ is not exactly like the free $\phi$ field):
\begin{itemize}
    \item We assume there is a unique ground state so that the first excited state is a single particle.
    \item We also want $\phi\ket{0}$ to be a single particle, i.e.
    $\bra{0}\phi \ket{0}=0$. If instead $\bra{0}\phi\ket{0}= v \neq 0$, we simply redefine the field by a shift, $\tilde \phi = \phi-v$ such that $\bra{0}\tilde \phi\ket{0}=0.$
    \item We want $\phi$ normalized such that $\bra{k}\phi\ket{0}=e^{ik\cdot x}$ as in the free case. With interactions, we may need to instead rescale $\phi \to Z_\phi^{1/2} \phi$. 
\end{itemize}
With these assumptions (and some careful thought about multi-particle states), the LSZ formula still applies. For instance,
\begin{align*}
    \cL &= \frac{1}{2} \p_\mu \phi \p^\mu \phi -\frac{1}{2} m^2 \phi^2 +\text{interactions}\\
    &\to \frac{1}{2} Z_\phi \p_\mu \phi \p^\mu \phi-\frac{1}{2} Z_m m^2 \phi^2 +\ldots
\end{align*}
after renormalization.%
    \footnote{That is, we can always choose the kinetic term to be canonically normalized. We'll discuss more about these factors later when we start to consider loop corrections, divergences, and the full machinery of renormalization.}